I"‹&<blockquote>
  <p>æ¥ä¸Šç¯‡ <a href="https://oragekk.me/08-25-2019/react2.html">ReactNative è®¤çŸ¥ï¼ˆäºŒï¼‰</a></p>
</blockquote>

<h2 id="reactnative-stateçŠ¶æ€">ReactNative State(çŠ¶æ€)</h2>

<h3 id="æ¦‚å¿µ">æ¦‚å¿µ</h3>

<p>é€šä¿—æ¥è®²ï¼Œä¸€ä¸ªç»„ä»¶ï¼Œæˆ–è€…ä¸€ä¸ªè§†å›¾ï¼Œä»–ä»¬éƒ½æ˜¯Componentï¼ŒComponentç”¨ä¸¤ä¸ªæœ€é‡è¦çš„ä¸œè¥¿ï¼Œä¸€ä¸ª<code class="highlighter-rouge">props</code></p>

<p>ä¸€ä¸ª<code class="highlighter-rouge">state</code></p>

<p>æˆ‘ä»¬ä½¿ç”¨ä¸¤ç§æ•°æ®æ¥æ§åˆ¶ä¸€ä¸ªç»„ä»¶ï¼š<code class="highlighter-rouge">props</code>å’Œ<code class="highlighter-rouge">state</code>ã€‚<code class="highlighter-rouge">props</code>æ˜¯åœ¨çˆ¶ç»„ä»¶ä¸­æŒ‡å®šï¼Œè€Œä¸”ä¸€ç»æŒ‡å®šï¼Œåœ¨è¢«æŒ‡å®šçš„ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸­åˆ™ä¸å†æ”¹å˜ã€‚(<code class="highlighter-rouge">props</code>å°±åƒä¸€ä¸ªç±»çš„åˆå§‹åŒ–å±æ€§ä¸€æ ·ï¼Œåªæœ‰åœ¨åˆ›å»ºæ—¶å¯ä»¥èµ‹å€¼ï¼Œå¹¶ä¸”ç»„ä»¶å†…éƒ¨ä¸å¯ä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯<code class="highlighter-rouge">readonly</code>)</p>

<p>å¯¹äºéœ€è¦æ”¹å˜çš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code class="highlighter-rouge">state</code>ã€‚ä¹Ÿå¯ä»¥æŠŠ<code class="highlighter-rouge">state</code>ç†è§£ä¸ºä¸€ä¸ªçŠ¶æ€æœºï¼Œå¯¹äºé‚£äº›éœ€è¦æ”¹å˜çš„æ•°æ®å¯ä»¥ä½¿ç”¨<code class="highlighter-rouge">state</code>æ¥æ›´æ”¹ï¼Œæ¯”å¦‚ç½‘ç»œæ¥å£æ‹¿å›æ¥çš„æ•°æ®ï¼Œå¯ä»¥æ”¾åœ¨<code class="highlighter-rouge">state</code>é‡Œï¼Œå½“éœ€è¦æ”¹å˜çš„æ—¶å€™åªéœ€è¦è°ƒç”¨<code class="highlighter-rouge">setState</code>å³å¯</p>

<h3 id="ä½¿ç”¨">ä½¿ç”¨</h3>

<p>ä¸€èˆ¬æ¥è¯´ï¼Œä½ éœ€è¦åœ¨classä¸­å£°æ˜ä¸€ä¸ª<code class="highlighter-rouge">state</code>å¯¹è±¡ï¼Œç„¶ååœ¨éœ€è¦ä¿®æ”¹æ—¶è°ƒç”¨<code class="highlighter-rouge">setState</code>æ–¹æ³•ã€‚</p>

<p>å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå¼¹çª—ï¼Œæƒ³è¦æ§åˆ¶å¼¹çª—æ˜¯ä¸æ˜¯æ˜¾ç¤ºï¼Œéœ€è¦ä¸€ä¸ª<code class="highlighter-rouge">modalVisible</code>å±æ€§ï¼Œå½“æ›´æ”¹å®ƒçš„å€¼æ—¶ä»è€Œä½¿ç•Œé¢UIäº§ç”Ÿç›¸åº”çš„å˜åŒ–</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// å£°æ˜stateå¯¹è±¡</span>
<span class="kr">interface</span> <span class="nx">IState</span> <span class="p">{</span>
    <span class="nl">modalVisible</span><span class="p">:</span> <span class="nx">boolean</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">ModalMenu</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="o">&lt;</span><span class="nx">IProps</span><span class="p">,</span><span class="nx">IState</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="na">props</span><span class="p">:</span> <span class="nx">IProps</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">modalVisible</span><span class="p">:</span> <span class="kc">false</span> <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
  
  
</code></pre></div></div>

<p>å¦ä¸€ç§å£°æ˜æ–¹å¼ï¼Œå£°æ˜åœ¨ç±»å†…éƒ¨ï¼Œå£°æ˜çš„åŒæ—¶ï¼Œè¿›è¡Œåˆå§‹åŒ–</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">modalVisible</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">};</span>
</code></pre></div></div>
<p>ä½¿ç”¨<code class="highlighter-rouge">this.state.modalVisible</code>æ¥æ§åˆ¶ç»„ä»¶æ˜¯å¦æ˜¾ç¤º</p>
<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">Modal</span>
                <span class="nx">animationType</span><span class="o">=</span><span class="dl">"</span><span class="s2">fade</span><span class="dl">"</span>
                <span class="nx">transparent</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span>
                <span class="nx">visible</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">modalVisible</span><span class="p">}</span>
                <span class="nx">onRequestClose</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">setModalVisible</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
                <span class="p">}}</span>
            <span class="o">&gt;</span>
               
        <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>æ›´æ–°ç»„ä»¶çŠ¶æ€ä½¿ç”¨</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">modalVisible</span><span class="p">:</span> <span class="kc">true</span> <span class="p">});</span>
</code></pre></div></div>

<h3 id="æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</h3>

<p>å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šåœ¨å®šæ—¶å™¨å‡½æ•°ï¼ˆsetIntervalã€setTimeout ç­‰ï¼‰ä¸­æ¥æ“ä½œ stateã€‚å…¸å‹çš„åœºæ™¯æ˜¯åœ¨æ¥æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„æ–°æ•°æ®ï¼Œæˆ–è€…åœ¨ç”¨æˆ·è¾“å…¥æ•°æ®ä¹‹åã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›â€œçŠ¶æ€å®¹å™¨â€æ¯”å¦‚<a href="http://redux.js.org/index.html">Redux</a>æ¥ç»Ÿä¸€ç®¡ç†æ•°æ®æµã€‚</p>

<p>æ¯æ¬¡è°ƒç”¨<code class="highlighter-rouge">setState</code>æ—¶ï¼ŒBlinkApp éƒ½ä¼šé‡æ–°æ‰§è¡Œ render æ–¹æ³•é‡æ–°æ¸²æŸ“ã€‚</p>

<ul>
  <li>renderï¼ˆï¼‰ä¸­UIçš„å˜åŒ–åªæœ‰å½“ç»‘å®šçš„stateä¸­çš„æŸä¸ªå±æ€§å˜åŒ–åï¼Œæ‰ä¼šå˜åŒ–</li>
  <li>ä¸€åˆ‡ç•Œé¢å˜åŒ–éƒ½æ˜¯<code class="highlighter-rouge">çŠ¶æ€stateå˜åŒ–</code></li>
  <li><code class="highlighter-rouge">state</code>çš„ä¿®æ”¹å¿…é¡»é€šè¿‡<code class="highlighter-rouge">setState()</code>æ–¹æ³•
    <ul>
      <li>this.state.likes = 100; // è¿™æ ·çš„<code class="highlighter-rouge">ç›´æ¥èµ‹å€¼ä¿®æ”¹æ— æ•ˆï¼</code></li>
      <li>setState æ˜¯ä¸€ä¸ª merge åˆå¹¶æ“ä½œï¼Œåªä¿®æ”¹æŒ‡å®šå±æ€§ï¼Œä¸å½±å“å…¶ä»–å±æ€§</li>
      <li>setState æ˜¯<code class="highlighter-rouge">å¼‚æ­¥</code>æ“ä½œï¼Œä¿®æ”¹<code class="highlighter-rouge">ä¸ä¼šé©¬ä¸Šç”Ÿæ•ˆ</code></li>
    </ul>
  </li>
</ul>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code class="highlighter-rouge">setState</code>å†…éƒ¨çš„å£°æ˜</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setState</span><span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">S</span><span class="o">&gt;</span><span class="p">(</span>
            <span class="nx">state</span><span class="p">:</span> <span class="p">((</span><span class="nx">prevState</span><span class="p">:</span> <span class="nx">Readonly</span><span class="o">&lt;</span><span class="nx">S</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">props</span><span class="p">:</span> <span class="nx">Readonly</span><span class="o">&lt;</span><span class="nx">P</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">Pick</span><span class="o">&lt;</span><span class="nx">S</span><span class="p">,</span> <span class="nx">K</span><span class="o">&gt;</span> <span class="o">|</span> <span class="nx">S</span> <span class="o">|</span> <span class="kc">null</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="nx">Pick</span><span class="o">&lt;</span><span class="nx">S</span><span class="p">,</span> <span class="nx">K</span><span class="o">&gt;</span> <span class="o">|</span> <span class="nx">S</span> <span class="o">|</span> <span class="kc">null</span><span class="p">),</span>
            <span class="nx">callback</span><span class="p">?:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="k">void</span>
        <span class="p">):</span> <span class="k">void</span><span class="p">;</span>
</code></pre></div></div>

<p>å¦‚æœæƒ³è¦åŒæ­¥ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°callback?å®ƒæ˜¯å¯é€‰çš„</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">modalVisible</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},()</span><span class="o">=&gt;</span><span class="p">{</span>
            <span class="c1">// è¿™é‡Œæ˜¯åŒæ­¥çš„</span>
<span class="p">});</span>
</code></pre></div></div>

<hr />

<p>å‚è€ƒèµ„æ–™ï¼š</p>

<p><a href="https://reactnative.cn/docs/layout-props/#justifycontent">å®˜æ–¹æ–‡æ¡£</a></p>

<p><a href="https://www.jianshu.com/p/ae0a9ec1f8d6?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=seo_notes&amp;utm_source=recommendation">ES6 å»¶å±•æ“ä½œç¬¦ï¼ˆâ€¦ï¼‰</a></p>

<p><a href="https://www.tslang.cn/docs/home.html">typeScriptgä¸­æ–‡æ–‡æ¡£</a></p>

<p><a href="https://www.imooc.com/video/14286">ReactNativeå…¥é—¨ä¸è¿›é˜¶</a></p>

<p><a href="[https://docs.nativebase.io](https://docs.nativebase.io/)">https://docs.nativebase.io </a></p>

:ET